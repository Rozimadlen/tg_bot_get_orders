# üöÄ Telegram Bot System - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### 1. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É templates (–µ—Å–ª–∏ –µ—ë –Ω–µ—Ç)
mkdir -p templates

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å dashboard.html –≤ templates
mv dashboard.html templates/dashboard.html

# –°–æ–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏
mkdir -p data/exports
mkdir -p data/logs  
mkdir -p sessions
```

### 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã

–°–æ–∑–¥–∞–π—Ç–µ —ç—Ç–∏ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:

- `shared_db.py` - –æ–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `improved_app.py` - —É–ª—É—á—à–µ–Ω–Ω—ã–π Telegram –±–æ—Ç  
- `simplified_web_server.py` - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- `main.py` - –≥–ª–∞–≤–Ω—ã–π –∑–∞–ø—É—Å–∫–Ω–æ–π —Ñ–∞–π–ª

### 3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã

**–ó–∞–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ä—ã–π `app.py` –Ω–∞ `improved_app.py`** –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `app.py`:

```python
# –í –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ –¥–æ–±–∞–≤–∏—Ç—å:
from shared_db import db

# –í —Ñ—É–Ω–∫—Ü–∏–∏ forward_with_card –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î:
lead_id = db.add_lead(
    chat_source=getattr(src_entity, "username", str(src_entity.id)),
    chat_name=chat_title,
    sender_id=message.sender_id,
    sender_name=display,
    message_text=message.text or "",
    quality_score=lead_analysis['score'],
    quality_label=lead_analysis['quality'],
    quality_reasons=lead_analysis['reasons']
)
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env

```env
API_ID=your_telegram_api_id
API_HASH=your_telegram_api_hash
TOGETHER_API_KEY=your_together_ai_key
FORWARD_TO=me
```

## üéØ –í–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
python main.py --mode combined
```
**–ß—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- ‚úÖ Telegram –±–æ—Ç (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ + –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (http://localhost:8080)
- ‚úÖ –û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢–æ–ª—å–∫–æ Telegram –±–æ—Ç
```bash
python main.py --mode telegram
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –¢–æ–ª—å–∫–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
python main.py --mode web
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
python main.py --mode status
```

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É:
```bash
python main.py --mode status
```

–í—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
```
üìä –°–¢–ê–¢–£–° TELEGRAM BOT SYSTEM
============================================================
üìÅ –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã: ‚úÖ OK
üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: ‚úÖ OK  
üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ‚úÖ OK (15 –ª–∏–¥–æ–≤)
‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: ‚úÖ OK
üîë –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: ‚úÖ OK (67 —Ñ—Ä–∞–∑)
üí¨ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —á–∞—Ç–æ–≤: ‚úÖ OK (2 —á–∞—Ç–∞)
============================================================
üéâ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É!
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã: ‚ùå –û—à–∏–±–∫–∏"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤:
ls -la shared_db.py improved_app.py simplified_web_server.py main.py
ls -la templates/dashboard.html
ls -la config.json keywords.txt chats.txt .env

# –ï—Å–ª–∏ dashboard.html –≤ –∫–æ—Ä–Ω–µ:
mv dashboard.html templates/

# –ï—Å–ª–∏ –Ω–µ—Ç –ø–∞–ø–∫–∏ templates:
mkdir templates
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: ‚ùå –û—à–∏–±–∫–∏"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª:
cat .env

# –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
API_ID=12345678
API_HASH=your_hash_here
TOGETHER_API_KEY=your_key_here
FORWARD_TO=me
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ‚ùå –û—à–∏–±–∫–∞"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
chmod 755 data/
touch data/shared_bot.sqlite

# –ò–ª–∏ —É–¥–∞–ª–∏—Ç–µ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ:
rm -f data/shared_bot.sqlite
python -c "from shared_db import db; print('–ë–î —Å–æ–∑–¥–∞–Ω–∞')"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç 8080 –∑–∞–Ω—è—Ç

**–†–µ—à–µ–Ω–∏–µ 1 - –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ simplified_web_server.py:**
```python
# –í –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ –∑–∞–º–µ–Ω–∏—Ç–µ:
socketio.run(app, host='0.0.0.0', port=8081, debug=True)  # –±—ã–ª 8080
```

**–†–µ—à–µ–Ω–∏–µ 2 - –û—Å–≤–æ–±–æ–¥–∏—Ç–µ –ø–æ—Ä—Ç:**
```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 8080:
lsof -i :8080

# –ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å:
kill -9 PID_–ü–†–û–¶–ï–°–°–ê
```

## üì± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram API

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://my.telegram.org/apps
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `API_ID` –∏ `API_HASH`
5. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env` —Ñ–∞–π–ª

## ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Together.ai

1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ https://together.ai/
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
TOGETHER_API_KEY=your_together_api_key_here
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
telegram-bot-system/
‚îú‚îÄ‚îÄ main.py                    # üöÄ –ì–ª–∞–≤–Ω—ã–π –∑–∞–ø—É—Å–∫–Ω–æ–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ shared_db.py              # üóÑÔ∏è –û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ improved_app.py           # ü§ñ –£–ª—É—á—à–µ–Ω–Ω—ã–π Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ simplified_web_server.py  # üåê –í–µ–±-—Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ app.py                    # üì± –°—Ç–∞—Ä—ã–π –±–æ—Ç (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
‚îú‚îÄ‚îÄ web_server.py            # üåê –°—Ç–∞—Ä—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
‚îú‚îÄ‚îÄ config.json              # ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ keywords.txt             # üîë –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
‚îú‚îÄ‚îÄ chats.txt               # üí¨ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —á–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ .env                    # üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ dashboard.html      # üìä –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ shared_bot.sqlite   # üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ exports/           # üìÅ –≠–∫—Å–ø–æ—Ä—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ logs/             # üìù –õ–æ–≥–∏
‚îî‚îÄ‚îÄ sessions/             # üîê –°–µ—Å—Å–∏–∏ Telegram
```

## üéØ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### 1. –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (combined)
- **–ß—Ç–æ:** Telegram –±–æ—Ç + –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ü–æ—Ä—Ç—ã:** 8080 (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **–ö–æ–º–∞–Ω–¥–∞:** `python main.py --mode combined`

### 2. –¢–æ–ª—å–∫–æ –±–æ—Ç (telegram)  
- **–ß—Ç–æ:** –¢–æ–ª—å–∫–æ Telegram —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **–ü–æ—Ä—Ç—ã:** –ù–µ—Ç
- **–ö–æ–º–∞–Ω–¥–∞:** `python main.py --mode telegram`

### 3. –¢–æ–ª—å–∫–æ –≤–µ–± (web)
- **–ß—Ç–æ:** –¢–æ–ª—å–∫–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ü–æ—Ä—Ç—ã:** 8080
- **–ö–æ–º–∞–Ω–¥–∞:** `python main.py --mode web`

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –±—ã–ª–∞ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è:

1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
```bash
cp keywords.txt keywords_backup.txt
cp chats.txt chats_backup.txt
cp config.json config_backup.json
```

2. **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª—ã:**
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ `dashboard.html` –≤ `templates/`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:**
```bash
python main.py --mode status
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É:**
```bash
python main.py --mode combined
```

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f "python.*main.py"
pkill -f "python.*app.py"

# 2. –û—á–∏—Å—Ç–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
rm -rf data/shared_bot.sqlite
rm -rf sessions/

# 3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
mkdir -p templates data/exports data/logs sessions

# 4. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã
mv dashboard.html templates/ 2>/dev/null || true

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É
python main.py --mode status

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
python main.py --mode combined
```

## üéâ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üöÄ –ó–ê–ü–£–°–ö TELEGRAM BOT SYSTEM
============================================================
‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!

üåê –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞...
ü§ñ –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞...
üéâ –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞!
üìä –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:8080
ü§ñ Telegram –±–æ—Ç: –∞–∫—Ç–∏–≤–µ–Ω
‚èπÔ∏è –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
============================================================
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:8080 - –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ä–∞–±–æ—á–∏–π –¥–∞—à–±–æ—Ä–¥!

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
python main.py --mode status

# –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫
python main.py --mode combined

# –¢–æ–ª—å–∫–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
python main.py --mode telegram

# –¢–æ–ª—å–∫–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–±–µ–∑ Telegram)  
python main.py --mode web

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f data/logs/parser.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
sqlite3 data/shared_bot.sqlite ".tables"
```
